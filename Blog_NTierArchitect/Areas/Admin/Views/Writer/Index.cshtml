@model IEnumerable<EntityLayer.Concrete.Writer>

@{
    ViewData["Title"] = "Yazarlar";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}



<p>
    <a asp-action="Create">Create New</a>
</p>
<table class="table">
    <thead>
        <tr>
            <th>
                Foto
            </th>
            <th>
                Ad-Soyad
            </th>
            <th>
                Email
            </th>
            <th>
                Status
            </th>
            <th>
                Haqqında
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody id="writerList">
    </tbody>
</table>

<div style=" background-color:lightgoldenrodyellow; padding:15px">
    <p>
        <button type="button" id="btnGetByID" class="btn btn-bitbucket">Yazar gətir</button>
    </p>
    <h3>ID-yə uyğun yazarın gətirilməsi  </h3>
    <input type="number" name="id" class="form-control" placeholder="yazar ID" id="writerID" />
    <br />
    <div class="col-lg-12">
        <div class="contact-box" id="getByID">

        </div>
    </div>
</div>


<div style=" background-color:lightgoldenrodyellow; padding:15px">
    <p>
        <button type="button" id="btnGetByID" class="btn btn-bitbucket">Yazar gətir</button>
    </p>
    <h3>ID-yə uyğun yazarın gətirilməsi  </h3>
    <input type="number" name="id" class="form-control" placeholder="yazar ID" id="writerID" />
    <br />
    <div class="col-lg-12">
        <div class="contact-box" id="getByID">

        </div>
    </div>
</div>

@section Scripts {
    <script>
        window.onload = function () {
            $.ajax({
                contentType: "application/json",
                dataType: "json",
                type: "Get",
                url: "/Admin/Writer/GetAllWriters",
                success: function (list) {
                    let writers = jQuery.parseJSON(list)
                    //console.log(writers);
                    let bodyRows = "";

                    $.each(writers, (index, value) => {
                        bodyRows += `<tr><td><img src="${value.Image}" style="width:50px; height:50px" /></td><td>${value.Name}</td><td>${value.Email}</td><td>${value.Status}</td><td>${value.About}</td><td><a href="/Admin/Writer/Edit/${value.ID}" title="Düzəliş Et"><i class="fa fa-edit test" style="color:green"></i></a> | <a href="/Admin/Writer/Delete/${value.ID}" title="Sil" onclick="return confirm('Seçdiyiniz sətr silinəcək. Silinən məlumatların geri qaytarılması mümkün deyil. \n Sətiri yənədə silmək istəyirsinizmi?')"><i class="fa fa-trash-alt" style="color:red"></i></a></td></tr >`;
                    });

                    $("#writerList").html(bodyRows);
                },
            });
        };

        $('#btnGetByID').click(x => {
            let id = $('#writerID').val();
            $.ajax({
                contentType: "application/json",
                dataType: "json",
                type: "Get",
                url: "/Admin/Writer/GetWriter",
                data: { id: id },
                success: function (data) {
                    let writer = jQuery.parseJSON(data);
                    //console.log(writer);
                    let table = `<a class="row" href="/Admin/Writer/Edit/${writer.ID}"><div class="col-4"><div class="text-center"><img alt="image" class="rounded-circle m-t-xs img-fluid" src="${writer.Image}"><div class="m-t-xs font-bold">${writer.Status}</div></div></div><div class="col-8"><h3><strong>${writer.Name}</strong></h3><p>${writer.Email}</p><address>${writer.About}</address></div></a>`;

                    $("#getByID").html(table);
                }
            })
        });
    </script>
}

